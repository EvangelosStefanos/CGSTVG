OUTPUT_DIR: output/vidstg/checkpoints/
DATA_DIR: data/vidstg/
TENSORBOARD_DIR: output/vidstg/checkpoints/tensorboard/

INPUT:
  RESOLUTION: 32 # 100 is ~8GB
  FLIP_PROB_TRAIN: 0.7
  TEMP_CROP_PROB: 0.5
  TRAIN_SAMPLE_NUM: 64

MODEL:
  WEIGHT: ./pretrained_models/pretrained_resnet101_checkpoint.pth
  VISION_BACKBONE:
    NAME: resnet101
    POS_ENC: sine
  TEXT_MODEL:
    NAME: roberta-base
  CG:
    FROM_SCRATCH: True
    USE_LEARN_TIME_EMBED: False
    USE_ACTION: True
    TEMP_THETA: -0.5
    SPAT_GT_THETA: 0.5
    SPAT_THETA: 0.5

DATASET:
  NAME: VidSTG

DATALOADER:
  NUM_WORKERS: 2
  ASPECT_RATIO_GROUPING: False

SOLVER:
  MAX_EPOCH: 1
  BATCH_SIZE: 1
  BBOX_COEF: 5
  GIOU_COEF: 3
  TEMP_COEF: 1
  ATTN_COEF: 1
  CONF_COEF: 1
  ACTIONESS_COEF: 2
  EOS_COEF: 0.3
  SIGMA: 2.0
  BASE_LR: 3e-4
  TEXT_LR: 5e-5
  VIS_BACKBONE_LR: 1e-5
  TEMP_LR: 1e-4
  OPTIMIZER: adamw
  VAL_PERIOD: 260000
  CHECKPOINT_PERIOD: 20000
  SHUFFLE: True
  SCHEDULE:
    TYPE: multistep_with_warmup_all
    DROP_STEP: [8,10]
  PRE_VAL: False


nodes: 8
tasks_per_node: 8
image_tag: in1k-16f
video_tag: k400-16x8x3
image_eval_name: image_classification_frozen
video_eval_name: video_classification_frozen
resume_checkpoint: false
data:
  root_path: /home/ilias/PycharmProjects/pythonProject1/jepa/imagenet/
  image_folder: ./
  num_classes: 20
  resolution: 224
  dataset_name: ImageNet
  dataset_train: /home/ilias/PycharmProjects/pythonProject1/jepa/kinetics400_train.csv
  dataset_val: /home/ilias/PycharmProjects/pythonProject1/jepa/kinetics400_val.csv
  dataset_type: VideoDataset
  frames_per_clip: 16
  num_segments: 8
  num_views_per_segment: 3
  frame_step: 4

optimization:
  num_epochs: 20
  batch_size: 16
  weight_decay: 0.001
  lr: 0.001
  start_lr: 0.001
  final_lr: 0.0
  warmup: 0.
  use_bfloat16: true
  attend_across_segments: true
  resolution: 224


pretrain:
  model_name: vit_large
  checkpoint_key: target_encoder
  clip_duration: null
  frames_per_clip: 16
  tubelet_size: 2
  uniform_power: true
  use_sdpa: true
  use_silu: false
  tight_silu: false
  patch_size: 16
  folder: /home/ilias/PycharmProjects/pythonProject1/jepa/checkpoints/pretrained/ViT-L
  checkpoint: vitl16.pth.tar  # name of pretrained model file inside folder
  write_tag: jepa